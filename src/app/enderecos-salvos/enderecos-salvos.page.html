<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home"></ion-back-button>
    </ion-buttons>
    <ion-title>Meus EndereÃ§os Salvos</ion-title>
    
    <!-- O botÃ£o de Exportar Geral foi removido daqui, focando na exportaÃ§Ã£o individual por item. -->
    
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">

  <!-- Mensagem de lista vazia -->
  @if (savedAddresses.length === 0) {
    <div class="ion-text-center ion-padding-top">
      <ion-icon name="map-outline" size="large" color="medium"></ion-icon>
      <p class="ion-padding-top">VocÃª nÃ£o possui nenhum endereÃ§o salvo.</p>
      <ion-button routerLink="/buscar-endereco">Buscar e Salvar EndereÃ§o</ion-button>
    </div>
  }

  <!-- Lista de EndereÃ§os Salvos -->
  @if (savedAddresses.length > 0) {
    <ion-list lines="full">
      
      <!-- Loop sobre a lista de endereÃ§os -->
      @for (address of savedAddresses; track address.id) {
        
        <!-- ğŸŒŸ Item Sliding para a aÃ§Ã£o de arrastar (Swipe-to-Action) ğŸŒŸ -->
        <ion-item-sliding>
          
          <!-- OpÃ§Ã£o de Exportar (Aparece ao deslizar para a DIREITA - slot="start") -->
          <!-- ğŸš¨ CORREÃ‡ÃƒO: Usando slot="start" E side="start" para garantir que o deslize para a direita funcione. -->
          <ion-item-options slot="start" side="start">
            <!-- ğŸš¨ ESTE BOTÃƒO CHAMA A FUNÃ‡ÃƒO DE EXPORTAÃ‡ÃƒO ğŸš¨ -->
            <ion-item-option color="secondary" (click)="exportSingleAddressToTxt(address)">
              <!-- Ãcone de Compartilhar/Salvar -->
              <ion-icon slot="icon-only" name="share-outline"></ion-icon>
            </ion-item-option>
          </ion-item-options>

          <!-- OpÃ§Ãµes de AÃ§Ã£o (Aparece ao deslizar para a ESQUERDA - slot="end") -->
          <!-- Adicionando side="end" por consistÃªncia, mesmo que jÃ¡ funcionasse -->
          <ion-item-options slot="end" side="end">
            <ion-item-option color="danger" (click)="confirmDelete(address)">
              <!-- Ãcone de Excluir -->
              <ion-icon slot="icon-only" name="trash-outline"></ion-icon>
            </ion-item-option>
          </ion-item-options>
          
          <!-- ConteÃºdo do Item que desliza -->
          <ion-item detail="false">
            <ion-icon name="location-outline" slot="start" color="primary"></ion-icon>
            
            <ion-label class="ion-text-wrap">
              <!-- EndereÃ§o principal -->
              <h2>{{ address.logradouro || 'EndereÃ§o sem rua' }}</h2>
              <!-- Complemento e Cidade/UF -->
              <p>{{ address.bairro }} â€” {{ address.localidade }} / {{ address.uf }}</p>
            </ion-label>
            
            <!-- InformaÃ§Ã£o do CEP -->
            <ion-note slot="end" class="ion-text-wrap">{{ address.cep }}</ion-note>
            
          </ion-item>
          
        </ion-item-sliding>
        
      }
    </ion-list>
  }

</ion-content>